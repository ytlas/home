#!/usr/bin/env python2
# Imports
from os.path import expanduser
import os.path
import subprocess

#Config
home=expanduser("~")
user="rabbit"
address="ytlas.com"
path=home+"/www"

#String needed for checking if a directory is already mounted
mount=subprocess.Popen("mount", shell=True, stdout=subprocess.PIPE).stdout.read()
if path in mount:
    yn=raw_input("Mount at "+path+" already found, unmount? (Y/n)")
    if(yn=="y"):
        print "Attempting to unmount..."
        fusermount=subprocess.Popen("fusermount -u "+path, shell=True, stdout=subprocess.PIPE).stdout.read()
    else:
        exit()
    if(fusermount):
        if input("A problem may have occurred, do you wish to try and do a lazy unmount? (Y/n) (Requires sudo privileges)").lower()=="y":
            fusermount=subprocess.Popen("sudo umount -l "+path, shell=True, stdout=subprocess.PIPE).stdout.read()
        else:
            exit()
else:
    print "Attempting to mount "+user+"@"+address+" on a remote directory ("+path+") on local directory "+home+"/www"
    sshfs=subprocess.Popen("sshfs "+user+"@"+address+":"+path+" "+path, shell=True, stdout=subprocess.PIPE).stdout.read()
    if(sshfs):
        print "Something may have went wrong, here is the output:"
        print sshfs

print "Exiting"
